var Ot=Object.defineProperty;var ht=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,Dt=Object.prototype.propertyIsEnumerable;var J=(e,t,n)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D=(e,t)=>{for(var n in t||(t={}))Tt.call(t,n)&&J(e,n,t[n]);if(ht)for(var n of ht(t))Dt.call(t,n)&&J(e,n,t[n]);return e};var a=(e,t,n)=>(J(e,typeof t!="symbol"?t+"":t,n),n);import{j as Rt,a as It,F as Nt,_ as R,p as Lt,S as Xt}from"./vendor.39f216ad.js";const Yt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};Yt();var w;(function(e){e[e.POINTER=1]="POINTER",e[e.DRAW_NODE=2]="DRAW_NODE",e[e.DRAW_LINK=3]="DRAW_LINK",e[e.DRAW_ACCEPT=4]="DRAW_ACCEPT",e[e.ELIMINATE=5]="ELIMINATE",e[e.PAN=6]="PAN"})(w||(w={}));var dt;(function(e){e[e.LOAD=1]="LOAD",e[e.SAVE=2]="SAVE",e[e.UNDO=3]="UNDO",e[e.REDO=4]="REDO",e[e.SUBSET_CONSTRUCT=5]="SUBSET_CONSTRUCT",e[e.RESET_ZOOM=6]="RESET_ZOOM",e[e.FORCE_EXPAND=7]="FORCE_EXPAND"})(dt||(dt={}));var B;(function(e){e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(B||(B={}));function W(e,t,n,s,i,o,c,l,h){return e*i*h+t*o*c+n*s*l-e*o*l-t*s*h-n*i*c}function Ct(e,t,n,s,i,o){const c=W(e,t,1,n,s,1,i,o,1),l=-W(e*e+t*t,t,1,n*n+s*s,s,1,i*i+o*o,o,1),h=W(e*e+t*t,e,1,n*n+s*s,n,1,i*i+o*o,i,1),r=-W(e*e+t*t,e,t,n*n+s*s,n,s,i*i+o*o,i,o);return{x:-l/(2*c),y:-h/(2*c),radius:Math.sqrt(l*l+h*h-4*c*r)/(2*Math.abs(c))}}function g(e,t){return e.toFixed(t).replace(/0+$/,"").replace(/\.$/,"")}const A=30,Z=6,G=6,U=30,_t={x:800,y:600},zt="black",$t="blue",Ft="green";class Y{constructor(){a(this,"selected",!1);a(this,"active",!1);a(this,"text","")}curr_colour(){return this.selected?$t:this.active?Ft:zt}}const ut=["Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"];function C(e,t,n,s,i,o,c=!1){const l=pt(t);e.font='20px "Times New Roman", serif';const h=ft(l);if(n-=h/2,i!=null){const r=Math.cos(i),d=Math.sin(i),f=(h/2+5)*(r>0?1:-1),p=(10+5)*(d>0?1:-1),x=d*Math.pow(Math.abs(d),40)*f-r*Math.pow(Math.abs(r),10)*p;n+=f-d*x,s+=p+r*x}"advancedFillText"in e?e.advancedFillText(l,t,n+h/2,s,i):(n=Math.round(n),s=Math.round(s),e.fillText(l,n,s+6),o&&c&&document.hasFocus()&&(n+=h,e.beginPath(),e.moveTo(n,s-10),e.lineTo(n,s+10),e.stroke()))}function z(e,t,n,s){const i=Math.cos(s),o=Math.sin(s);e.beginPath(),e.moveTo(t,n),e.lineTo(t-8*i+5*o,n-8*o-5*i),e.lineTo(t-8*i-5*o,n-8*o+5*i),e.fill()}function ft(e){const t=st();if(t!=null){const n=t.ctx;if(n!=null)return n.font='20px "Times New Roman", serif',n.measureText(e).width}return 0}function pt(e){for(let t=0;t<ut.length;t++){const n=ut[t];e=e.replace(new RegExp("\\\\"+n,"g"),String.fromCharCode(913+t+ +(t>16))),e=e.replace(new RegExp("\\\\"+n.toLowerCase(),"g"),String.fromCharCode(945+t+ +(t>16)))}for(let t=0;t<10;t++)e=e.replace(new RegExp("_"+t,"g"),String.fromCharCode(8320+t));return e}function Bt(e){e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let t="";for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s>=32&&s<=126?t+=e[n]:t+="&#"+s+";"}return t}class P extends Y{constructor(t,n){super();a(this,"nodeA");a(this,"nodeB");a(this,"text");a(this,"lineAngleAdjust");a(this,"parallelPart");a(this,"perpendicularPart");this.nodeA=t,this.nodeB=n,this.text="",this.lineAngleAdjust=0,this.parallelPart=.5,this.perpendicularPart=0}get_anchor_point(){const t=this.nodeB.x-this.nodeA.x,n=this.nodeB.y-this.nodeA.y,s=Math.sqrt(t*t+n*n);return{x:this.nodeA.x+t*this.parallelPart-n*this.perpendicularPart/s,y:this.nodeA.y+n*this.parallelPart+t*this.perpendicularPart/s}}set_anchor_point(t,n){const s=this.nodeB.x-this.nodeA.x,i=this.nodeB.y-this.nodeA.y,o=Math.sqrt(s*s+i*i);this.parallelPart=(s*(t-this.nodeA.x)+i*(n-this.nodeA.y))/(o*o),this.perpendicularPart=(s*(n-this.nodeA.y)-i*(t-this.nodeA.x))/o,this.parallelPart>0&&this.parallelPart<1&&Math.abs(this.perpendicularPart)<Z&&(this.lineAngleAdjust=+(this.perpendicularPart<0)*Math.PI,this.perpendicularPart=0)}get_endpoints_and_circle(){if(this.perpendicularPart==0){const f=(this.nodeA.x+this.nodeB.x)/2,p=(this.nodeA.y+this.nodeB.y)/2,x=this.nodeA.closest_point_on_circle(f,p),b=this.nodeB.closest_point_on_circle(f,p);return{hasCircle:!1,startX:x.x,startY:x.y,endX:b.x,endY:b.y}}const t=this.get_anchor_point(),n=Ct(this.nodeA.x,this.nodeA.y,this.nodeB.x,this.nodeB.y,t.x,t.y),s=this.perpendicularPart>0,i=s?1:-1,o=Math.atan2(this.nodeA.y-n.y,this.nodeA.x-n.x)-i*A/n.radius,c=Math.atan2(this.nodeB.y-n.y,this.nodeB.x-n.x)+i*A/n.radius,l=n.x+n.radius*Math.cos(o),h=n.y+n.radius*Math.sin(o),r=n.x+n.radius*Math.cos(c),d=n.y+n.radius*Math.sin(c);return{hasCircle:!0,startX:l,startY:h,endX:r,endY:d,startAngle:o,endAngle:c,circleX:n.x,circleY:n.y,circleRadius:n.radius,reverseScale:i,isReversed:s}}draw(t,n=!1){const s=this.get_endpoints_and_circle();if(t.beginPath(),s.hasCircle?t.arc(s.circleX,s.circleY,s.circleRadius,s.startAngle,s.endAngle,s.isReversed):(t.moveTo(s.startX,s.startY),t.lineTo(s.endX,s.endY)),t.stroke(),s.hasCircle?z(t,s.endX,s.endY,s.endAngle-s.reverseScale*(Math.PI/2)):z(t,s.endX,s.endY,Math.atan2(s.endY-s.startY,s.endX-s.startX)),s.hasCircle){let i=s.startAngle,o=s.endAngle;o<i&&(o+=Math.PI*2);const c=(i+o)/2+ +s.isReversed*Math.PI,l=s.circleX+s.circleRadius*Math.cos(c),h=s.circleY+s.circleRadius*Math.sin(c);C(t,this.text,l,h,c,this.selected,n)}else{const i=(s.startX+s.endX)/2,o=(s.startY+s.endY)/2,c=Math.atan2(s.endX-s.startX,s.startY-s.endY);C(t,this.text,i,o,c+this.lineAngleAdjust,this.selected,n)}}contains_point(t){const n=t.x,s=t.y,i=this.get_endpoints_and_circle();if(i.hasCircle){const o=n-i.circleX,c=s-i.circleY,l=Math.sqrt(o*o+c*c)-i.circleRadius;if(Math.abs(l)<G){let h=Math.atan2(c,o),r=i.startAngle,d=i.endAngle;if(i.isReversed){const f=r;r=d,d=f}return d<r&&(d+=Math.PI*2),h<r?h+=Math.PI*2:h>d&&(h-=Math.PI*2),h>r&&h<d}}else{const o=i.endX-i.startX,c=i.endY-i.startY,l=Math.sqrt(o*o+c*c),h=(o*(n-i.startX)+c*(s-i.startY))/(l*l),r=(o*(s-i.startY)-c*(n-i.startX))/l;return h>0&&h<1&&Math.abs(r)<G}return!1}}class j extends Y{constructor(t,n){super();a(this,"node");a(this,"text");a(this,"anchorAngle");a(this,"mouseOffsetAngle");this.node=t,this.anchorAngle=0,this.mouseOffsetAngle=0,this.text="",n&&this.set_anchor_point(n.x,n.y)}set_mouse_start(t,n){this.mouseOffsetAngle=this.anchorAngle-Math.atan2(n-this.node.y,t-this.node.x)}set_anchor_point(t,n){this.anchorAngle=Math.atan2(n-this.node.y,t-this.node.x)+this.mouseOffsetAngle;const s=Math.round(this.anchorAngle/(Math.PI/2))*(Math.PI/2);Math.abs(this.anchorAngle-s)<.1&&(this.anchorAngle=s),this.anchorAngle<-Math.PI&&(this.anchorAngle+=2*Math.PI),this.anchorAngle>Math.PI&&(this.anchorAngle-=2*Math.PI)}get_endpoints_and_circle(){const t=this.node.x+1.5*A*Math.cos(this.anchorAngle),n=this.node.y+1.5*A*Math.sin(this.anchorAngle),s=.75*A,i=this.anchorAngle-Math.PI*.8,o=this.anchorAngle+Math.PI*.8,c=t+s*Math.cos(i),l=n+s*Math.sin(i),h=t+s*Math.cos(o),r=n+s*Math.sin(o);return{hasCircle:!0,startX:c,startY:l,endX:h,endY:r,startAngle:i,endAngle:o,circleX:t,circleY:n,circleRadius:s}}draw(t,n=!1){const s=this.get_endpoints_and_circle();t.beginPath(),t.arc(s.circleX,s.circleY,s.circleRadius,s.startAngle,s.endAngle,!1),t.stroke();const i=s.circleX+s.circleRadius*Math.cos(this.anchorAngle),o=s.circleY+s.circleRadius*Math.sin(this.anchorAngle);C(t,this.text,i,o,this.anchorAngle,this.selected,n),z(t,s.endX,s.endY,s.endAngle+Math.PI*.4)}contains_point(t){const n=this.get_endpoints_and_circle(),s=t.x-n.circleX,i=t.y-n.circleY,o=Math.sqrt(s*s+i*i)-n.circleRadius;return Math.abs(o)<G}}class E extends Y{constructor(t,n){super();a(this,"node");a(this,"deltaX");a(this,"deltaY");a(this,"text");this.node=t,this.deltaX=0,this.deltaY=0,this.text="",n&&this.set_anchor_point(n.x,n.y)}set_anchor_point(t,n){this.deltaX=t-this.node.x,this.deltaY=n-this.node.y,Math.abs(this.deltaX)<Z&&(this.deltaX=0),Math.abs(this.deltaY)<Z&&(this.deltaY=0)}get_start_point(){return{x:this.node.x+this.deltaX,y:this.node.y+this.deltaY}}get_endpoints(){const t=this.node.x+this.deltaX,n=this.node.y+this.deltaY,s=this.node.closest_point_on_circle(t,n);return{startX:t,startY:n,endX:s.x,endY:s.y}}draw(t,n=!1){const s=this.get_endpoints();t.beginPath(),t.moveTo(s.startX,s.startY),t.lineTo(s.endX,s.endY),t.stroke();const i=Math.atan2(s.startY-s.endY,s.startX-s.endX);C(t,this.text,s.startX,s.startY,i,this.selected,n),z(t,s.endX,s.endY,Math.atan2(-this.deltaY,-this.deltaX))}contains_point(t){const n=t.x,s=t.y,i=this.get_endpoints(),o=i.endX-i.startX,c=i.endY-i.startY,l=Math.sqrt(o*o+c*c),h=(o*(n-i.startX)+c*(s-i.startY))/(l*l),r=(o*(s-i.startY)-c*(n-i.startX))/l;return h>0&&h<1&&Math.abs(r)<G}}class y extends Y{constructor(t,n){super();a(this,"x");a(this,"y");a(this,"mouseOffsetX");a(this,"mouseOffsetY");a(this,"isAcceptState");a(this,"text");this.x=t,this.y=n,this.mouseOffsetX=0,this.mouseOffsetY=0,this.isAcceptState=!1,this.text=""}set_mouse_start(t,n){this.mouseOffsetX=this.x-t,this.mouseOffsetY=this.y-n}set_anchor_point(t,n){this.x=t+this.mouseOffsetX,this.y=n+this.mouseOffsetY}draw(t,n=!1){t.beginPath(),t.arc(this.x,this.y,A,0,2*Math.PI,!1),t.stroke(),C(t,this.text,this.x,this.y,null,this.selected,n),this.isAcceptState&&(t.beginPath(),t.arc(this.x,this.y,A-6,0,2*Math.PI,!1),t.stroke())}closest_point_on_circle(t,n){const s=t-this.x,i=n-this.y,o=Math.sqrt(s*s+i*i);return{x:this.x+s*A/o,y:this.y+i*A/o}}contains_point(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)<A*A}}function Q(e){typeof window!="undefined"&&localStorage&&JSON&&(localStorage.fsm=K(e))}function Wt(e){if(typeof window!="undefined"){if(!localStorage||!JSON)return;try{const t=localStorage.getItem("fsm");if(t!=null){const n=H(t);e.nodes=n.nodes,e.links=n.links}}catch{localStorage.fsm=""}return["nodes","links"]}}function H(e){const t=[],n=[];if(!JSON)return{nodes:t,links:n};const s=JSON.parse(e);for(let i=0;i<s.nodes.length;i++){const o=s.nodes[i],c=new y(o.x,o.y);c.isAcceptState=o.isAcceptState,c.text=o.text,t.push(c)}for(let i=0;i<s.links.length;i++){const o=s.links[i];let c=null;o.type=="SelfLink"?(c=new j(t[o.node]),c.anchorAngle=o.anchorAngle,c.text=o.text):o.type=="StartLink"?(c=new E(t[o.node]),c.deltaX=o.deltaX,c.deltaY=o.deltaY,c.text=o.text):(o.type=="NodeLink"||o.type=="Link")&&(c=new P(t[o.nodeA],t[o.nodeB]),c.parallelPart=o.parallelPart,c.perpendicularPart=o.perpendicularPart,c.text=o.text,c.lineAngleAdjust=o.lineAngleAdjust),c!=null&&n.push(c)}return{nodes:t,links:n}}function K(e){if(!JSON)return"";const t=e.nodes,n=e.links,s={nodes:[],links:[]};for(let i=0;i<t.length;i++){const o=t[i];let c={x:o.x,y:o.y,text:o.text,isAcceptState:o.isAcceptState};s.nodes.push(c)}for(let i=0;i<n.length;i++){const o=n[i];let c;o instanceof j?c={type:"SelfLink",node:t.indexOf(o.node),text:o.text,anchorAngle:o.anchorAngle}:o instanceof E?c={type:"StartLink",node:t.indexOf(o.node),text:o.text,deltaX:o.deltaX,deltaY:o.deltaY}:o instanceof P&&(c={type:"NodeLink",nodeA:t.indexOf(o.nodeA),nodeB:t.indexOf(o.nodeB),text:o.text,lineAngleAdjust:o.lineAngleAdjust,parallelPart:o.parallelPart,perpendicularPart:o.perpendicularPart}),c!=null&&s.links.push(c)}return JSON.stringify(s)}let T=[],O="",I=[];function Gt(e){return T=[],I=[],O=K(e),e.can={undo:!1,redo:!1},["can"]}function tt(e){const t=K(e);O!=t&&(T.push(O),O=t,I=[])}function gt(e){if(e.selected_object!=null)return e.selected_object.selected=!1,e.selected_object=void 0,["selected_object"]}function Ut(e){if(m(gt),T.length>0){let t=T.pop();I.push(O),O=t;const n=H(t);return e.nodes=n.nodes,e.links=n.links,e.can.undo=T.length>0,e.can.redo=I.length>0,["nodes","links","can"]}else{console.warn("Tried to undo with no actions to undo.");return}}function Ht(e){m(gt);let t=I.pop();if(t!=null){T.push(O),O=t;const n=H(t);return e.nodes=n.nodes,e.links=n.links,e.can.undo=T.length>0,e.can.redo=I.length>0,["nodes","links","can"]}else{console.warn("Tried to redo with no actions to redo.");return}}function Kt(e){e.last_tool=e.curr_tool}function qt(e){e.canvas.draw()}const N={temp_link:void 0,canvas:void 0,view_zone:{zoom:1,x:0,y:0},active_objects:[],selected_object:void 0,nodes:[],links:[],last_tool:w.POINTER,curr_tool:w.POINTER,can:{undo:!1,redo:!1},file_name:"untitled"},L={temp_link:[],canvas:[],view_zone:[],active_objects:[],selected_object:[],nodes:[],links:[],last_tool:[],curr_tool:[],can:[],file_name:[]},Vt={temp_link:[],canvas:[qt],view_zone:[],active_objects:[],selected_object:[tt,Q],nodes:[tt,Q],links:[tt,Q],last_tool:[],curr_tool:[Kt],can:[],file_name:[]},mt=new Map;function et(e,t){for(const n of e)L[n].includes(t)||L[n].push(t);mt.set(t,e)}function Jt(e){const t=mt.get(e);if(t!=null)for(let n of t)for(let s=L[n].length-1;s>=0;s--)e==L[n][s]&&(L[n].splice(s,1),s--)}let nt;function st(){return nt}function Zt(e){nt==null&&(nt=e),N.canvas=e}function it(e){const t=[];for(const n of e)for(const s of Vt[n])t.includes(s)||t.push(s);for(const n of t)n(N)}function m(e,t=!0){let n=e(N);n!=null&&(t&&it(n),ot(n))}function xt(e,t=!0,...n){let s=e(N,...n);s!=null&&(t&&it(s),ot(s))}function Qt(e){ot(e),it(e)}function k(e){return N[e]}function te(e){return e(N)}function ot(e){const t=[];for(const n of e)for(const s of L[n])t.includes(s)||t.push(s);for(const n of t)n.setState({})}const u={CONCAT:"*&*",KLEIN:"*",OR:"+",OPEN_LEFT:"(",CLOSE_RIGHT:")"},ee=[u.OR,u.OPEN_LEFT,u.CLOSE_RIGHT],ne=[u.CONCAT,u.OR],se=[u.KLEIN],ie=[u.OPEN_LEFT,u.OR,u.CONCAT,u.KLEIN],oe=[u.CLOSE_RIGHT,u.OR,u.CONCAT],vt={[u.KLEIN]:8,[u.CONCAT]:4,[u.OR]:2},$="\\epsilon";function ct(e,t){for(const n of t)e.includes(n)||e.push(n)}function M(e){return e instanceof y?`${e.text}:${e.x},${e.y}`:e instanceof P?`${M(e.nodeA)}->${M(e.nodeB)}:${e.text}${e.get_anchor_point().x},${e.get_anchor_point().y}`:e instanceof E?`${M(e.node)}:${e.get_start_point().x},${e.get_start_point().y}`:JSON.stringify(e)}function bt(){const e=st();if(e!=null){const t=e.el;if(t!=null)return{x:Math.random()*(t.width-2*U)+U,y:Math.random()*(t.height-2*U)+U}}return{x:0,y:0}}class wt{constructor(){a(this,"state_names");a(this,"transitions");a(this,"starting_state");a(this,"accepting_states");this.state_names=[],this.transitions=new Map,this.starting_state=-1,this.accepting_states=[]}load(t,n){this.state_names=[],this.transitions=new Map,this.starting_state=-1,this.accepting_states=[];const s=new Map;let i=0;for(let o=0;o<t.length;o++){const c=t[o];s.set(M(c),i),this.state_names.push(c.text),c.isAcceptState&&this.accepting_states.push(i),i++}for(let o=0;o<n.length;o++){const c=n[o];if(c instanceof P){const l=s.get(M(c.nodeA)),h=s.get(M(c.nodeB)),r=c.text.split(",").map(d=>d.trim());if(l!=null&&h!=null){let d=this.transitions.get(l);d==null&&(d=new Map,this.transitions.set(l,d));for(const f of r){let p=d.get(f);p==null&&(p=[],d.set(f,p)),p.push(h)}}}else if(c instanceof j){const l=s.get(M(c.node)),h=l,r=c.text.split(",").map(d=>d.trim());if(l!=null&&h!=null){let d=this.transitions.get(l);d==null&&(d=new Map,this.transitions.set(l,d));for(const f of r){let p=d.get(f);p==null&&(p=[],d.set(f,p)),p.push(h)}}}else if(c instanceof E){const l=s.get(M(c.node));l!=null&&(this.starting_state=l)}}}create_elements(){const t=[],n=[],s=new Map;for(let i=0;i<this.state_names.length;i++){const o=bt(),c=new y(o.x,o.y);c.text=this.state_names[i],s.set(i,c),this.accepting_states.includes(i)&&(c.isAcceptState=!0),t.push(c)}for(const[i,o]of this.transitions.entries()){const c=s.get(i);if(c!=null)for(const[l,h]of o.entries())for(const r of h){const d=s.get(r);if(d!=null){let f;i==r?f=new j(c):(f=new P(c,d),f.perpendicularPart+=100*Math.random()),f.text=l,n.push(f)}}}if(this.starting_state!=-1){const i=s.get(this.starting_state);if(i!=null){const o=new E(i),c=bt();o.set_anchor_point(c.x,c.y),o.text="start",n.push(o)}}return{nodes:t,links:n}}add_transitions(t,n,s){let i=this.transitions.get(t);i==null&&(i=new Map,this.transitions.set(t,i));let o=i.get(n);o==null&&(o=[],i.set(n,o)),ct(o,s)}add_transition(t,n,s){let i=this.transitions.get(t);i==null&&(i=new Map,this.transitions.set(t,i));let o=i.get(n);o==null&&(o=[],i.set(n,o)),o.includes(s)||o.push(s)}deep_delta(t,n){const s=[];for(const i of this.get_equivalents(t))ct(s,this.shallow_delta(i,n));return this.get_equivalents(s).slice()}shallow_delta(t,n){let s=this.transitions.get(t);if(s!=null){let i=s.get(n);if(i!=null)return i.slice()}return[]}get_equivalents(t){Array.isArray(t)?t=t.slice():t=[t];const n=t.slice();let s=n.pop();for(;s!=null;){let i=this.shallow_delta(s,$);for(const o of i.values())t.includes(o)||(n.push(o),t.push(o));s=n.pop()}return t}is_deterministic(){for(const t of this.transitions.values())for(const[n,s]of t.entries())if(n==$||s.length>1)return!1;return!0}}function kt(e){const t=new wt,n=e.nodes,s=e.links;if(t.load(n,s),t.is_deterministic()){console.warn("Tried to perform subset construction on a DFA.");return}else if(t.starting_state==-1){console.warn("FA has no starting state so subset construction failed.");return}const i=ce(t),{nodes:o,links:c}=i.create_elements();return re(n,s,o,c),e.selected_object=void 0,["nodes","links"]}function ce(e){const t=new wt,n=new Map,s=[],i=[];let o=0;t.starting_state=0;const c=e.get_equivalents(e.starting_state);n.set(q(c),o);const l=Array.from(c).map(r=>e.state_names[r]);l.sort(),s.push(`{${l.join(",")}}`),i.push(c),Array.from(c).some(r=>e.accepting_states.includes(r))&&t.accepting_states.push(o),o++;let h=i.pop();for(;h!=null;){const r=q(h),d=new Map;for(const f of h){const p=e.transitions.get(f);if(p!=null){for(const x of p.keys())if(x!=$){let b=d.get(x);b==null&&(b=[],d.set(x,b)),ct(b,e.deep_delta(f,x))}}}for(const[f,p]of d.entries()){const x=q(p),b=n.get(r);if(n.has(x))t.add_transition(b,f,n.get(x));else{const X=q(p);n.set(X,o);const at=Array.from(p).map(V=>e.state_names[V]);at.sort(),s.push(`{${at.join(",")}}`),i.push(p),Array.from(p).some(V=>e.accepting_states.includes(V))&&t.accepting_states.push(o),t.add_transition(b,f,o),o++}}h=i.pop()}return t.state_names=s,t}function q(e){const t=e.slice();return t.sort(),t.join(",")}function re(e,t,n,s){e.splice(0,e.length),t.splice(0,t.length);for(let i=0;i<n.length;i++)e.push(n[i]);for(let i=0;i<s.length;i++)t.push(s[i])}function le(e){yt(K(e),`${e.file_name||new Date().toISOString().replace(/[^0-9|-]/g,"")}.fsmjson`,"application/json")}function ae(e,t){const n=document.createElement("a");n.href=e.toDataURL(),n.download=t,n.click(),URL.revokeObjectURL(n.href)}function yt(e,t,n="text/plain"){const s=new Blob([e],{type:n}),i=document.createElement("a");i.href=URL.createObjectURL(s),i.download=t,i.click(),URL.revokeObjectURL(i.href)}function he(e){de().then(t=>{const[n,s]=t;try{const i=H(n);e.nodes=i.nodes,e.links=i.links,e.file_name=s.substring(0,s.lastIndexOf(".")),Qt(["nodes","links","can","file_name","canvas"])}catch(i){console.error(i)}})}async function de(){return new Promise((e,t)=>{const n=document.createElement("input");n.type="file",n.accept=".fsmjson",n.oninput=s=>{const i=s.target.files[0];i.text().then(o=>e([o,i.name]))},n.click()})}function _e(e){return e.view_zone={zoom:1,x:0,y:0},["view_zone"]}class ue{constructor(){a(this,"fillStyle");a(this,"strokeStyle");a(this,"lineWidth");a(this,"font");a(this,"_points");a(this,"_svgData");a(this,"_transX");a(this,"_transY");this.fillStyle="black",this.strokeStyle="black",this.lineWidth=1,this.font="12px Arial, sans-serif",this._points=[],this._svgData="",this._transX=0,this._transY=0}toSVG(){return`<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg width="800" height="600" version="1.1" xmlns="http://www.w3.org/2000/svg">
`+this._svgData+`</svg>
`}beginPath(){this._points=[]}arc(t,n,s,i,o,c){t+=this._transX,n+=this._transY;const l='stroke="'+this.strokeStyle+'" stroke-width="'+this.lineWidth+'" fill="none"';if(o-i==Math.PI*2)this._svgData+="	<ellipse "+l+' cx="'+g(t,3)+'" cy="'+g(n,3)+'" rx="'+g(s,3)+'" ry="'+g(s,3)+`"/>
`;else{if(c){const b=i;i=o,o=b}o<i&&(o+=Math.PI*2);const h=t+s*Math.cos(i),r=n+s*Math.sin(i),d=t+s*Math.cos(o),f=n+s*Math.sin(o),p=Math.abs(o-i)>Math.PI,x=1;this._svgData+="	<path "+l+' d="',this._svgData+="M "+g(h,3)+","+g(r,3)+" ",this._svgData+="A "+g(s,3)+","+g(s,3)+" ",this._svgData+="0 ",this._svgData+=+p+" ",this._svgData+=+x+" ",this._svgData+=g(d,3)+","+g(f,3),this._svgData+=`"/>
`}}moveTo(t,n){t+=this._transX,n+=this._transY,this._points.push({x:t,y:n})}lineTo(t,n){t+=this._transX,n+=this._transY,this._points.push({x:t,y:n})}stroke(){if(this._points.length!=0){this._svgData+='	<polygon stroke="'+this.strokeStyle+'" stroke-width="'+this.lineWidth+'" points="';for(let t=0;t<this._points.length;t++)this._svgData+=(t>0?" ":"")+g(this._points[t].x,3)+","+g(this._points[t].y,3);this._svgData+=`"/>
`}}fill(){if(this._points.length!=0){this._svgData+='	<polygon fill="'+this.fillStyle+'" stroke-width="'+this.lineWidth+'" points="';for(let t=0;t<this._points.length;t++)this._svgData+=(t>0?" ":"")+g(this._points[t].x,3)+","+g(this._points[t].y,3);this._svgData+=`"/>
`}}fillText(t,n,s){n+=this._transX,s+=this._transY,t.replace(" ","").length>0&&(this._svgData+='	<text x="'+g(n,3)+'" y="'+g(s,3)+'" font-family="Times New Roman" font-size="20">'+Bt(t)+`</text>
`)}translate(t,n){this._transX=t,this._transY=n}save(){}restore(){}clearRect(){}rect(){}}function fe(e){const t=new ue;return e.selected_object!=null&&(e.selected_object.selected=!1,e.selected_object=void 0),e.canvas.draw_using(t),yt(t.toSVG(),`${e.file_name}.svg`,"image/svg+xml"),["selected_object"]}class pe{constructor(){a(this,"_points");a(this,"_texData");a(this,"_scale");a(this,"strokeStyle","black");a(this,"fillStyle","black");a(this,"lineWidth",1);a(this,"font","");this._points=[],this._texData="",this._scale=.1}toLaTeX(){return`\\documentclass[12pt]{article}
\\usepackage{tikz}

\\begin{document}

\\begin{center}
\\begin{tikzpicture}[scale=0.2]
\\tikzstyle{every node}+=[inner sep=0pt]
`+this._texData+`\\end{tikzpicture}
\\end{center}

\\end{document}
`}beginPath(){this._points=[]}arc(t,n,s,i,o,c){if(t*=this._scale,n*=this._scale,s*=this._scale,o-i==Math.PI*2)this._texData+="\\draw ["+this.strokeStyle+"] ("+g(t,3)+","+g(-n,3)+") circle ("+g(s,3)+`);
`;else{if(c){const l=i;i=o,o=l}o<i&&(o+=Math.PI*2),Math.min(i,o)<-2*Math.PI?(i+=2*Math.PI,o+=2*Math.PI):Math.max(i,o)>2*Math.PI&&(i-=2*Math.PI,o-=2*Math.PI),i=-i,o=-o,this._texData+="\\draw ["+this.strokeStyle+"] ("+g(t+s*Math.cos(i),3)+","+g(-n+s*Math.sin(i),3)+") arc ("+g(i*180/Math.PI,5)+":"+g(o*180/Math.PI,5)+":"+g(s,3)+`);
`}}moveTo(t,n){t*=this._scale,n*=this._scale,this._points.push({x:t,y:n})}lineTo(t,n){t*=this._scale,n*=this._scale,this._points.push({x:t,y:n})}stroke(){if(this._points.length!=0){this._texData+="\\draw ["+this.strokeStyle+"]";for(let t=0;t<this._points.length;t++){const n=this._points[t];this._texData+=(t>0?" --":"")+" ("+g(n.x,2)+","+g(-n.y,2)+")"}this._texData+=`;
`}}fill(){if(this._points.length!=0){this._texData+="\\fill ["+this.strokeStyle+"]";for(let t=0;t<this._points.length;t++){const n=this._points[t];this._texData+=(t>0?" --":"")+" ("+g(n.x,2)+","+g(-n.y,2)+")"}this._texData+=`;
`}}advancedFillText(t,n,s,i,o){if(t.replace(" ","").length>0){let c="";if(o!=null){const l=ft(t),h=Math.cos(o),r=Math.sin(o);Math.abs(h)>Math.abs(r)?h>0?(c="[right] ",s-=l/2):(c="[left] ",s+=l/2):r>0?(c="[below] ",i-=10):(c="[above] ",i+=10)}s*=this._scale,i*=this._scale,this._texData+="\\draw ("+g(s,2)+","+g(-i,2)+") node "+c+"{$"+n.replace(/ /g,"\\mbox{ }")+`$};
`}}translate(){}save(){}restore(){}clearRect(){}rect(){}}function ge(e){const t=new pe;return e.selected_object!=null&&(e.selected_object.selected=!1,e.selected_object=void 0),e.canvas.draw_using(t),navigator.clipboard.writeText(t.toLaTeX()),["selected_object"]}function me(e){e.selected_object!=null&&(e.selected_object.selected=!1,e.selected_object=void 0);const t=document.createElement("canvas");return t.width=800,t.height=600,e.canvas.draw_using(t.getContext("2d")),ae(t,`${e.file_name}.png`),["selected_object"]}const _=Rt,v=It,rt=Nt;class xe extends R{constructor(){super();et(["can"],this)}render(){return v(rt,{children:[_("div",{children:"Actions:"}),v("div",{style:"display: flex; flex-direction: row; flex-wrap: wrap;",children:[_(S,{text:"Undo",icon:"",handle_click:Ut}),_(S,{text:"Redo",icon:"",handle_click:Ht}),_(S,{text:"Subset Construction",icon:"",handle_click:kt}),_(S,{text:"Save",icon:"",handle_click:le}),_(S,{text:"Load",icon:"",handle_click:he}),_(S,{text:"Reset Cam",icon:"",handle_click:_e}),_(S,{text:"Save PNG",icon:"",handle_click:me}),_(S,{text:"Save SVG",icon:"",handle_click:fe}),_(S,{text:"Copy LaTeX",icon:"",handle_click:ge})]})]})}}class S extends R{constructor(t){super(t)}render(){return _("div",{onClick:t=>m(this.props.handle_click),children:this.props.text})}}function ve(e){const t=be(e),n=[],s=[];for(let o=0;o<t.length;o++){const c=t[o];if(c==u.KLEIN)s.push(c);else if(ne.includes(c)){for(;s.length>0;){let l=s[s.length-1];if(l!=u.OPEN_LEFT&&vt[l]>=vt[c]){const h=s.pop();h!=null&&n.push(h)}else break}s.push(c)}else if(c==u.OPEN_LEFT)s.push(c);else if(c==u.CLOSE_RIGHT){for(;s.length>0&&s[s.length-1]!=u.OPEN_LEFT;){const h=s.pop();h!=null&&n.push(h)}if(s.length==0&&console.error("The operator stack is empty, fix the parentheses."),s.pop(),s.length>0&&se.includes(s[length-1])){const l=s.pop();l!=null&&n.push(l)}}else n.push(c)}let i=s.pop();for(;i!=null;)n.push(i),i=s.pop();return n}function be(e){e=e.replace(/(\w)\*/g,"($1)*"),e=pt(e);const t=[];let n=0,s=0;for(;s<e.length;){if(ee.includes(e[s]))n!=s&&t.push(e.slice(n,s)),n=s+1,t.push(e[s]);else if(e[s]==u.KLEIN){let i=t.length-1,o=0;for(;i>=0&&(t[i]==u.CLOSE_RIGHT?o++:t[i]==u.OPEN_LEFT&&o--,o!=0);)i--;t.splice(i,0,e[s]),n=s+1}s++}for(n!=s&&t.push(e.slice(n)),s=t.length-1;s>0;)!ie.includes(t[s-1])&&!oe.includes(t[s])&&t.splice(s,0,u.CONCAT),s--;return t}function we(e,t,n){if(e.isAcceptState)return!1;const s=[],i=[],o=[],c=[];for(let r=0;r<n.length;r++){const d=n[r];if(d instanceof j&&d.node==e)o.push(d);else if(d instanceof P)d.nodeA==e?i.push(d):d.nodeB==e&&s.push(d);else if(d instanceof E&&d.node==e)return!1}let l="";if(o.length>0){const r=[];for(let d=0;d<o.length;d++)r.push(...o[d].text.split(","));r.length==1&&r[0].length==1?l=`${r[0]}*`:r.length>0&&(l=`(${r.join("+")})*`)}for(let r=0;r<s.length;r++){const d=s[r];for(let f=0;f<i.length;f++){const p=i[f];let x,b;b=`${At(d.text.split(",").map(X=>X.trim()).join("+"))}${l}${At(p.text.split(",").map(X=>X.trim()).join("+"))}`,d.nodeA==p.nodeB?x=new j(d.nodeA):x=new P(d.nodeA,p.nodeB),b=Ae(ke(b)),x.text=b,n.push(x)}}let h=n.length;for(;h--;)(s.some(r=>r==n[h])||i.some(r=>r==n[h])||o.some(r=>r==n[h]))&&n.splice(h,1);t.splice(t.indexOf(e),1);for(let r=0;r<c.length;r++)n.push(c[r]);return ye(n),!0}function ke(e){return e.replace(new RegExp(`/([)*w])(${$})/g`),"$1").replace(new RegExp(`/(${$})([(w])/g`),"$2")}function ye(e){const t=[],n=new Map;for(let i=0;i<e.length;i++){const o=e[i];if(o instanceof j){let c=M(o.node);const l=n.get(c);l!=null?l.push(o):n.set(c,[o])}else if(o instanceof P){let c=M(o.nodeA)+M(o.nodeB);const l=n.get(c);l!=null?l.push(o):n.set(c,[o])}}for(const i of n.values())if(i.length>1){i[0].text=`${i.map(o=>o.text).join("+")}`;for(let o=1;o<i.length;o++)t.push(i[o])}let s=e.length;for(;s--;)t.includes(e[s])&&e.splice(s,1)}function At(e){if(e.includes("+")){let t=ve(e);if(t.length>0&&t[t.length-1]==u.OR)if(e.charAt(0)==u.OPEN_LEFT&&e.charAt(e.length-1)==u.CLOSE_RIGHT){let n=0;for(let s=1;s<e.length-1;s++)if(e[s]==u.OPEN_LEFT?n++:e[s]==u.CLOSE_RIGHT&&n--,n<0)return`(${e})`;if(n!=0)return console.warn(`String "${e}" has non matching number of parentheses.`),e}else return`(${e})`}return e}function Ae(e){if(e.length>2&&e.charAt(0)==u.OPEN_LEFT&&e.charAt(e.length-1)==u.CLOSE_RIGHT){let t=0;for(let n=1;n<e.length-1;n++)if(e[n]==u.OPEN_LEFT?t++:e[n]==u.CLOSE_RIGHT&&t--,t<0)return e;return t!=0?e:e.substring(1,e.length-1)}return e}class Mt extends Y{constructor(t,n){super();a(this,"from");a(this,"to");this.from=t,this.to=n}draw(t,n=!1){t.beginPath(),t.moveTo(this.to.x,this.to.y),t.lineTo(this.from.x,this.from.y),t.stroke(),z(t,this.to.x,this.to.y,Math.atan2(this.to.y-this.from.y,this.to.x-this.from.x))}contains_point(t){return!1}set_anchor_point(t,n){}}function Me(e){e.selected_object!=null&&(e.selected_object.selected=!1);const t=e.canvas.cursor.obj_at_last_pos;return e.selected_object=t,t!=null&&(t.selected=!0,(t instanceof y||t instanceof j)&&t.set_mouse_start(e.canvas.cursor.mouse_down_pos.x,e.canvas.cursor.mouse_down_pos.y)),["selected_object"]}function Pt(e){if(e.canvas.cursor.obj_at_last_pos==null){const t=e.canvas.cursor.last_pos,n=new y(t.x,t.y);return n.selected=!0,e.selected_object!=null&&(e.selected_object.selected=!1),e.selected_object=n,e.nodes.push(n),["nodes","selected_object"]}}function jt(e){const t=e.canvas.cursor.obj_at_last_pos;return t instanceof y&&(t.isAcceptState=!t.isAcceptState),e.selected_object=t,["selected_object"]}function Pe(e){const t=e.canvas.cursor.last_pos;if(e.selected_object!=null)return e.selected_object.set_anchor_point(t.x,t.y),["nodes","links","selected_object"];{const n=D({},e.view_zone);return n.x=n.zoom*(t.x-e.canvas.cursor.mouse_down_pos.x)+n.x,n.y=n.zoom*(t.y-e.canvas.cursor.mouse_down_pos.y)+n.y,e.view_zone=n,["view_zone"]}}function St(e){let t;const n=e.canvas.cursor.obj_at_mouse_down,s=e.canvas.cursor.obj_at_last_pos,i=D({},e.canvas.cursor.mouse_down_pos),o=D({},e.canvas.cursor.last_pos);return n instanceof y&&s instanceof y?n==s?(t=new j(n),t.set_mouse_start(i.x,i.y),t.set_anchor_point(o.x,o.y)):t=new P(n,s):s instanceof y?t=new E(s,i):t=new Mt(n instanceof y?n.closest_point_on_circle(o.x,o.y):i,o),e.temp_link=t,["temp_link"]}function je(e){return e.temp_link instanceof Mt||(e.links.push(e.temp_link),e.temp_link.selected=!0,e.selected_object!=null&&(e.selected_object.selected=!1),e.selected_object=e.temp_link),e.temp_link=void 0,["links","temp_link"]}function Et(e){let t=!1;const n=[e.selected_object,...e.active_objects];for(const s of n)s instanceof y&&(t=t||we(s,e.nodes,e.links));return e.selected_object!=null&&(e.selected_object.selected=!1,e.selected_object=void 0),t?["nodes","links","selected_object"]:void 0}function Se(e){if(e.selected_object!=null){if(e.selected_object instanceof y){for(let t=e.nodes.length-1;t>=0;t--)if(e.selected_object==e.nodes[t]){e.nodes.splice(t,1);break}for(let t=e.links.length-1;t>=0;t--){const n=e.links[t];let s=!1;n instanceof P?s=n.nodeA==e.selected_object||n.nodeB==e.selected_object:(n instanceof E||n instanceof j)&&(s=n.node==e.selected_object),s&&e.links.splice(t,1)}}else for(let t=e.links.length-1;t>=0;t--)if(e.selected_object==e.links[t]){e.links.splice(t,1);break}return e.selected_object=void 0,["nodes","links","selected_object"]}}function Ee(e,t){if(e.selected_object!=null)return e.selected_object.text=e.selected_object.text+t,["selected_object"]}function Oe(e){if(e.selected_object!=null)return e.selected_object.text=e.selected_object.text.substring(0,e.selected_object.text.length-1),["selected_object"]}function Te(e){if(e.selected_object!=null)return["nodes","links"]}function De(e,t){const n=e.view_zone,s=D({},n),i=e.canvas.event_to_canvas_space(t);return s.zoom=Math.min(Math.max(s.zoom*Math.exp(-t.deltaY/1e3),.3),3),s.x=(n.zoom-s.zoom)*i.x+n.x,s.y=(n.zoom-s.zoom)*i.y+n.y,e.view_zone=s,["view_zone"]}function Re(e){const t=k("nodes"),n=k("links");for(let s=0;s<t.length;s++)if(t[s].contains_point(e))return t[s];for(let s=0;s<n.length;s++)if(n[s].contains_point(e))return n[s]}class Ie{constructor(t){a(this,"canvas");a(this,"mouse_down",t=>{switch(this.sync_canvas_coordinates(t,!0),this.canvas.cursor.mouse_down_pos=D({},this.canvas.cursor.last_pos),this.canvas.cursor.obj_at_mouse_down=this.canvas.cursor.obj_at_last_pos,m(Me),this.canvas.cursor.down=!0,k("curr_tool")){case w.DRAW_LINK:m(St,!1)}this.canvas.cursor.moving=!1});a(this,"mouse_up",t=>(this.sync_canvas_coordinates(t),this.canvas.cursor.down=!1,this.canvas.cursor.moving?m(Te):t.button==B.LEFT?this.left_click():t.button==B.RIGHT&&this.right_click(),k("temp_link")!=null&&m(je),this.canvas.cursor.moving=!1,t.preventDefault(),!1));a(this,"mouse_move",t=>{this.sync_canvas_coordinates(t,!0),this.canvas.cursor.moving=!0,this.canvas.cursor.down&&this.drag()});a(this,"dbl_click",t=>{this.sync_canvas_coordinates(t),this.canvas.cursor.obj_at_last_pos instanceof y?m(jt):m(Pt)});a(this,"wheel",t=>{if(!this.canvas.cursor.down)return xt(De,!0,t),t.preventDefault(),!1});a(this,"drag",()=>{switch(k("curr_tool")){case w.DRAW_LINK:{m(St,!1);break}default:m(Pe,!1)}});a(this,"left_click",()=>{switch(k("curr_tool")){case w.DRAW_NODE:m(Pt);break;case w.DRAW_ACCEPT:m(jt);break;case w.ELIMINATE:m(Et);break}});a(this,"right_click",()=>{m(kt)});this.canvas=t}prevent_default(t){return t.preventDefault(),!1}sync_canvas_coordinates(t,n=!1){this.canvas.cursor.last_pos=this.canvas.event_to_canvas_space(t),n&&(this.canvas.cursor.obj_at_last_pos=Re(this.canvas.cursor.last_pos))}}class Ne extends R{constructor(){super();a(this,"ref",Lt());a(this,"el");a(this,"ctx");a(this,"cursor");a(this,"handlers");a(this,"caret_interval",-1);a(this,"caret_function",()=>{k("selected_object")==null?(window.clearInterval(this.caret_interval),this.caret_interval=-1):this.setState({caret_visible:!this.state.caret_visible})});a(this,"draw",()=>{const t=k("view_zone");if(this.ctx!=null)this.ctx.setTransform(t.zoom,0,0,t.zoom,t.x,t.y),this.draw_using(this.ctx,!0);else if(this.el!=null){const n=this.el.getContext("2d");n!=null&&(this.ctx=n,n.setTransform(t.zoom,0,0,t.zoom,t.x,t.y),this.draw_using(n,!0))}});this.state={caret_visible:!1,selected_zone:void 0},this.cursor={mouse_down_pos:{x:0,y:0},obj_at_mouse_down:void 0,last_pos:{x:0,y:0},obj_at_last_pos:void 0,down:!1,moving:!1},this.handlers=new Ie(this)}componentDidMount(){Zt(this),this.el=this.ref.current,this.ctx=this.el.getContext("2d"),this.el.onmousedown=this.handlers.mouse_down,this.el.onmousemove=this.handlers.mouse_move,this.el.onmouseup=this.handlers.mouse_up,this.el.ondblclick=this.handlers.dbl_click,this.el.oncontextmenu=this.handlers.prevent_default,this.el.onwheel=this.handlers.wheel,et(["nodes","links","active_objects","selected_object","temp_link","view_zone"],this),te(this.draw)}componentWillUnmount(){Jt(this)}shouldComponentUpdate(){return this.reinit_caret(),this.draw(),!1}render(){return _("canvas",{ref:this.ref,id:"canvas",width:_t.x,height:_t.y,children:v("span",{children:["Your browser does not support",_("br",{}),"the HTML5 <canvas> element"]})})}reinit_caret(){k("selected_object")!=null&&this.caret_interval==-1&&(this.caret_interval=window.setInterval(this.caret_function,300))}event_to_canvas_space(t){const n=k("view_zone"),s=this.el.getBoundingClientRect(),i={x:t.clientX-s.x,y:t.clientY-s.y};return{x:(i.x-n.x)/n.zoom,y:(i.y-n.y)/n.zoom}}point_to_canvas_space(t){const n=k("view_zone");return{x:(t.x-n.x)/n.zoom,y:(t.y-n.y)/n.zoom}}draw_using(t,n=!1){if(this.el!=null){const s=k("nodes"),i=k("links"),o=k("selected_object"),c=k("temp_link"),l=this.point_to_canvas_space({x:0,y:0}),h=this.point_to_canvas_space({x:this.el.width,y:this.el.height});t.clearRect(l.x,l.y,h.x-l.x,h.y-l.y),t.save(),n&&(t.beginPath(),t.fillStyle="white",t.rect(-1,-1,this.el.width+2,this.el.height+2),t.fill(),t.stroke());for(let r=0;r<s.length;r++)t.lineWidth=1,t.fillStyle=t.strokeStyle=s[r].curr_colour(),s[r].draw(t,s[r]==o&&this.state.caret_visible);for(let r=0;r<i.length;r++)t.lineWidth=1,t.fillStyle=t.strokeStyle=i[r].curr_colour(),i[r].draw(t,i[r]==o&&this.state.caret_visible);c!=null&&(t.lineWidth=1,t.fillStyle=t.strokeStyle="black",c.draw(t,c==o&&this.state.caret_visible)),t.restore()}}}class Le extends R{constructor(){super();et(["curr_tool"],this)}render(){return v(rt,{children:[_("div",{children:"Tools:"}),v("div",{style:"display: flex; flex-direction: row;",children:[_(F,{tooltip:"Select",icon:"",tool_mode:w.POINTER}),_(F,{tooltip:"Draw Node",icon:"",tool_mode:w.DRAW_NODE}),_(F,{tooltip:"Draw Link",icon:"",tool_mode:w.DRAW_LINK}),_(F,{tooltip:"Draw Accept",icon:"",tool_mode:w.DRAW_ACCEPT}),_(F,{tooltip:"Eliminate",icon:"",tool_mode:w.ELIMINATE})]})]})}}class F extends R{constructor(t){super(t);a(this,"mutator",t=>{if(t.curr_tool!=this.props.tool_mode)return t.curr_tool=this.props.tool_mode,["curr_tool"]})}render(){return _("div",{onClick:t=>m(this.mutator),style:this.props.tool_mode==k("curr_tool")?"color: cyan":"color: black",children:this.props.tooltip})}}class Xe extends R{constructor(){super(...arguments);a(this,"canvas")}componentWillMount(){this.init()}componentDidMount(){this.canvas=st()}render(){return v(rt,{children:[v("div",{id:"preact_root",children:[_(xe,{}),_(Le,{}),_(Ne,{})]}),v("div",{children:[_("textarea",{id:"output"}),_("p",{children:"The big white box above is the FSM designer.\xA0 Here's how to use it:"}),v("ul",{children:[v("li",{children:[_("b",{children:"Add a state:"})," double-click on the canvas"]}),v("li",{children:[_("b",{children:"Add an arrow:"})," shift-drag on the canvas"]}),v("li",{children:[_("b",{children:"Move something:"})," drag it around"]}),v("li",{children:[_("b",{children:"Delete something:"})," click it and press the delete key (not the backspace key)"]})]}),v("ul",{children:[v("li",{children:[_("b",{children:"Make accept state:"})," double-click on an existing state"]}),v("li",{children:[_("b",{children:"Type numeric subscript:"}),' put an underscore before the number (like "S_0")']}),v("li",{children:[_("b",{children:"Type greek letter:"}),' put a backslash before it (like "\\beta")']}),v("li",{children:[_("b",{children:"Eliminate a non-accept, non-start state:"})," use the state tool or press ]"]}),v("li",{children:[_("b",{children:"Perform subset construction:"})," right click anywhere on the canvas"]})]}),_("p",{children:"This was made in HTML5 and JavaScript using the canvas element."})]}),v("p",{children:["Created by ",_("a",{href:"http://madebyevan.com/",children:"Evan Wallace"})," in 2010 ",_("br",{}),"+ Extended by ",_("a",{href:"https://alialhasnawi.github.io/",children:"Ali Al-Hasnawi in 2021"})]})]})}init(){m(Wt),m(Gt),typeof window!="undefined"&&(window.onkeydown=t=>{switch(t.key){case"Shift":m(n=>{if(n.curr_tool==w.DRAW_LINK){n.last_tool=n.curr_tool;return}return n.curr_tool=w.DRAW_LINK,["curr_tool"]},!1);break;case"Backspace":m(Oe,!1);break;case"]":m(Et);break;case"Delete":m(Se);break;default:t.key.length==1&&xt(Ee,!1,t.key)}return t.preventDefault(),!1},window.onkeyup=t=>(t.key=="Shift"&&m(n=>{if(n.curr_tool==w.DRAW_LINK)return n.curr_tool=n.last_tool,["curr_tool"]},!1),t.preventDefault(),!1))}}let lt=new Date().getTime();console.log("start render");Xt(_(Xe,{}),document.getElementById("app"));lt=new Date().getTime()-lt;console.log(`finished, took ${lt}ms!`);
